import{_ as C,e as O,r as f,f as M,o as a,c as o,F as D,a as s,t,g as x,d as y,p as N,h as T}from"./main-9b128242.js";const w=d=>(N("data-v-283fcd2d"),d=d(),T(),d),B={class:"channel__wrapper d-flex f-center f-col w-100 h-100"},F={key:0,class:"checking-text"},R={class:"channel__info m-bottom"},A=w(()=>s("span",null,t("距離 "),-1)),z={class:"channel-name"},L=w(()=>s("span",null,t(" 上次開台已經過了"),-1)),V={class:"channel__time"},E={class:"channel__time-text m-bottom"},H={class:"channel__time-text"},J={class:"channel__care d-flex f-center m-top"},P=["href"],Z=["href"],j={key:2,class:"invalid-text d-flex f-center f-col"},q={class:"m-bottom"},G=w(()=>s("span",null,t(" 目前沒有開台紀錄"),-1)),K={key:3,class:"invalid-text d-flex f-center"},Q={key:4,class:"invalid-text d-flex f-center"},U={__name:"Channel",setup(d){const p="https://service.starknows.tw",i=O().params.channelId,v=f(null),m=f(""),k=/@[0-9a-zA-Z\_\-\.]+$/gm.test(i),n=f(null),c=f(null),g=_=>{const l=new Date-new Date(_),h=Math.floor(l/864e5),r=l%864e5,u=Math.floor(r/36e5),e=r%36e5,I=Math.floor(e/6e4),$=e%6e4,S=Math.floor($/1e3);return[h,u,I,S]},b=async _=>{if(k)try{const h=await(await fetch(`${p}/auth`,{method:"post",headers:{"Content-Type":"application/json"}})).json(),r=JSON.stringify({channelId:_}),u={"Content-Type":"application/json"};h.token&&(u.Authorization=`Bearer ${h.token}`),fetch(`${p}/api/channel-name`,{method:"post",headers:u,body:r,credentials:"include"}).then(e=>e.json()).then(e=>{console.log("channel-name: ",e),m.value=e.data}),fetch(`${p}/api/last-stream`,{method:"post",headers:u,body:r,credentials:"include"}).then(e=>{switch(e.status){case 400:return n.value="unsafe",null;case 403:return n.value="empty",null;case 404:return n.value="error",null;default:return e.json()}}).then(e=>{console.log("last-stream: ",e),e&&(n.value="valid",v.value=e.lastLiveId,c.value=g(e.data),window.setInterval(()=>{c.value=g(e.data)},1e3))})}catch(l){console.log("error: ",l)}};return M(()=>{k?b(i):n="unsafe"}),(_,l)=>(a(),o("div",B,[n.value?n.value==="valid"?(a(),o(D,{key:1},[s("div",R,[A,s("span",z,t(m.value),1),L]),s("div",V,[s("span",E,t(`${c.value[0]} 天 ${c.value[1]}時 `),1),s("span",H,t(`${c.value[2]}分 ${c.value[3]}秒`),1)]),s("div",J,[x(i)?(a(),o("a",{key:0,href:`https://www.youtube.com/${x(i)}?sub_confirmation=1`,target:"_blank",rel:"nooppener noreferrer"},t(">> 關心主播"),8,P)):y("",!0),v.value?(a(),o("a",{key:1,href:`https://www.youtube.com/watch?v=${v.value}`,target:"_blank",rel:"nooppener noreferrer"},t(">> 緬懷主播"),8,Z)):y("",!0)])],64)):n.value==="empty"?(a(),o("div",j,[s("span",q,t(m.value),1),G])):n.value==="unsafe"?(a(),o("div",K,t("頻道 ID 錯誤"))):n.value==="error"?(a(),o("div",Q,t("錯誤發生"))):y("",!0):(a(),o("div",F,"Checking..."))]))}},Y=C(U,[["__scopeId","data-v-283fcd2d"]]);export{Y as default};
