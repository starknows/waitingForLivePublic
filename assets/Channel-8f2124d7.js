import{e as L,r as i,f as N,o as a,c as s,F as B,a as o,t as e,g as y,d as _,p as F,h as R}from"./main-ecebb506.js";const A=(c,f)=>{const w=c.__vccOpts||c;for(const[l,d]of f)w[l]=d;return w},k=c=>(F("data-v-fcd9966f"),c=c(),R(),c),P={class:"channel__wrapper d-flex f-center f-col w-100 h-100"},z={key:0,class:"checking-text"},U={class:"channel__info m-bottom"},V=k(()=>o("span",null,e("距離 "),-1)),E={class:"channel-name"},H=k(()=>o("span",null,e(" 上次開台已經過了"),-1)),J={class:"channel__time"},Z={class:"channel__time-text m-bottom"},q={class:"channel__time-text"},G={class:"channel__care d-flex f-center m-top f-wrap"},K=["href"],Q=["href"],W=["href"],X=["href"],Y={key:2,class:"invalid-text d-flex f-center f-col"},j={class:"m-bottom"},ee=k(()=>o("span",null,e(" 目前沒有開台紀錄"),-1)),te={key:3,class:"invalid-text d-flex f-center"},ne={key:4,class:"invalid-text d-flex f-center"},ae={key:5,class:"channel__info invalid-text d-flex f-center f-col"},se=k(()=>o("span",null,e("你推正在開台，你怎麼還在這？"),-1)),oe=["href"],ce={key:6,class:"invalid-text d-flex f-center"},le={__name:"Channel",setup(c){const f="https://service.starknows.tw",l=L().params.channelId,d=/@[0-9a-zA-Z\_\-\.]+$/gm.test(l),t=i(null),g=i(""),b=i(null),u=i(null),x=i(null),$=i(null),I=i(0),C=r=>{const h=new Date-new Date(r),v=Math.floor(h/864e5),p=h%864e5,m=Math.floor(p/36e5),n=p%36e5,T=Math.floor(n/6e4),M=n%6e4,D=Math.floor(M/1e3);return[v,m,T,D]},O=async r=>{if(d)try{const v=await(await fetch(`${f}/auth`,{method:"post",headers:{"Content-Type":"application/json"}})).json(),p=JSON.stringify({channelId:r}),m={"Content-Type":"application/json"};document.cookie,v.token&&(m.Authorization=`Bearer ${v.token}`),fetch(`${f}/api/channel-info`,{method:"post",headers:m,body:p,credentials:"include"}).then(n=>{switch(n.status){case 400:t.value="unsafe";break;case 403:t.value="empty";break;case 404:t.value="error";break;case 422:t.value="live";break;default:}return n.json()}).then(n=>{if(t.value){t.value==="live"&&(I.value=n.count);return}t.value="valid",b.value=n.lastLiveId,g.value=n.name,x.value=n.deer,$.value=n.ecpay,u.value=C(n.lastLiveTime),window.setInterval(()=>{u.value=C(n.lastLiveTime)},1e3)})}catch(h){}},S=r=>typeof r!="string"?null:r.replace("&#13;","");return N(()=>{d?O(l):t.value="unsafe"}),(r,h)=>(a(),s("div",P,[t.value?t.value==="valid"?(a(),s(B,{key:1},[o("div",U,[V,o("span",E,e(g.value),1),H]),o("div",J,[o("span",Z,e(`${u.value[0]} 天 ${u.value[1]}時 `),1),o("span",q,e(`${u.value[2]}分 ${u.value[3]}秒`),1)]),o("div",G,[y(l)?(a(),s("a",{key:0,href:`https://www.youtube.com/${y(l)}?sub_confirmation=1`,target:"_blank",rel:"nooppener noreferrer"},e(">> 關心主播"),8,K)):_("",!0),b.value?(a(),s("a",{key:1,href:`https://www.youtube.com/watch?v=${b.value}`,target:"_blank",rel:"nooppener noreferrer"},e(">> 緬懷主播"),8,Q)):_("",!0),x.value?(a(),s("a",{key:2,class:"highlight",href:`https://deerdonate.herokuapp.com/donation/${S(x.value)}`,target:"_blank",rel:"nooppener noreferrer"},e(">> 譴責主播"),8,W)):_("",!0),$.value?(a(),s("a",{key:3,class:"highlight",href:`https://p.ecpay.com.tw/${S($.value)}`,target:"_blank",rel:"nooppener noreferrer"},e(">> 譴責主播"),8,X)):_("",!0)])],64)):t.value==="empty"?(a(),s("div",Y,[o("span",j,e(g.value),1),ee])):t.value==="unsafe"?(a(),s("div",te,e("頻道 ID 錯誤"))):t.value==="error"?(a(),s("div",ne,e("錯誤發生"))):t.value==="live"?(a(),s("div",ae,[se,y(d)?(a(),s("a",{key:0,class:"highlight",href:`https://www.youtube.com/${y(l)}/live`,target:"_blank",rel:"nooppener noreferrer"},e(`>> 現場有 ${I.value} 人在等你`),9,oe)):_("",!0)])):t.value==="429"?(a(),s("div",ce,e("服務暫時無法使用"))):_("",!0):(a(),s("div",z,"Checking..."))]))}},ie=A(le,[["__scopeId","data-v-fcd9966f"]]);export{ie as default};
