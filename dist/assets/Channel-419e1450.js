import{a as M,r as i,b as D,o as n,c as o,F as L,d as s,t,e as $,f as _,p as N,g as R}from"./main-1653c90c.js";const A=(c,h)=>{const y=c.__vccOpts||c;for(const[l,d]of h)y[l]=d;return y},x=c=>(N("data-v-f906eadb"),c=c(),R(),c),B={class:"channel__wrapper d-flex f-center f-col w-100 h-100"},F={key:0,class:"checking-text"},P={class:"channel__info m-bottom"},U=x(()=>s("span",null,t("距離 "),-1)),V={class:"channel-name"},z=x(()=>s("span",null,t(" 上次開台已經過了"),-1)),E={class:"channel__time"},H={class:"channel__time-text m-bottom"},J={class:"channel__time-text"},Z={class:"channel__care d-flex f-center m-top f-wrap"},q=["href"],G=["href"],K=["href"],Q=["href"],W={key:2,class:"invalid-text d-flex f-center f-col"},X={class:"m-bottom"},Y=x(()=>s("span",null,t(" 目前沒有開台紀錄"),-1)),j={key:3,class:"invalid-text d-flex f-center"},ee={key:4,class:"invalid-text d-flex f-center"},te={__name:"Channel",setup(c){const h={}.VITE_API_URL,l=M().params.channelId,d=/@[0-9a-zA-Z\_\-\.]+$/gm.test(l),a=i(null),g=i(""),k=i(null),r=i(null),w=i(null),b=i(null),I=f=>{const u=new Date-new Date(f),p=Math.floor(u/864e5),v=u%864e5,m=Math.floor(v/36e5),e=v%36e5,C=Math.floor(e/6e4),O=e%6e4,T=Math.floor(O/1e3);return[p,m,C,T]},S=async f=>{if(d)try{const p=await(await fetch(`${h}/auth`,{method:"post",headers:{"Content-Type":"application/json"}})).json(),v=JSON.stringify({channelId:f}),m={"Content-Type":"application/json"};document.cookie,p.token&&(m.Authorization=`Bearer ${p.token}`),fetch(`${h}/api/channel-info`,{method:"post",headers:m,body:v,credentials:"include"}).then(e=>{switch(e.status){case 400:return a.value="unsafe",null;case 403:return a.value="empty",null;case 404:return a.value="error",null;default:return e.json()}}).then(e=>{e&&(a.value="valid",k.value=e.lastLiveId,g.value=e.name,w.value=e.deer,b.value=e.ecpay,r.value=I(e.lastLiveTime),window.setInterval(()=>{r.value=I(e.lastLiveTime)},1e3))})}catch(u){}};return D(()=>{d?S(l):a="unsafe"}),(f,u)=>(n(),o("div",B,[a.value?a.value==="valid"?(n(),o(L,{key:1},[s("div",P,[U,s("span",V,t(g.value),1),z]),s("div",E,[s("span",H,t(`${r.value[0]} 天 ${r.value[1]}時 `),1),s("span",J,t(`${r.value[2]}分 ${r.value[3]}秒`),1)]),s("div",Z,[$(l)?(n(),o("a",{key:0,href:`https://www.youtube.com/${$(l)}?sub_confirmation=1`,target:"_blank",rel:"nooppener noreferrer"},t(">> 關心主播"),8,q)):_("",!0),k.value?(n(),o("a",{key:1,href:`https://www.youtube.com/watch?v=${k.value}`,target:"_blank",rel:"nooppener noreferrer"},t(">> 緬懷主播"),8,G)):_("",!0),w.value?(n(),o("a",{key:2,class:"highlight",href:`https://deerdonate.herokuapp.com/donation/${w.value}`,target:"_blank",rel:"nooppener noreferrer"},t(">> 譴責主播"),8,K)):_("",!0),b.value?(n(),o("a",{key:3,class:"highlight",href:`https://p.ecpay.com.tw/${b.value}`,target:"_blank",rel:"nooppener noreferrer"},t(">> 譴責主播"),8,Q)):_("",!0)])],64)):a.value==="empty"?(n(),o("div",W,[s("span",X,t(g.value),1),Y])):a.value==="unsafe"?(n(),o("div",j,t("頻道 ID 錯誤"))):a.value==="error"?(n(),o("div",ee,t("錯誤發生"))):_("",!0):(n(),o("div",F,"Checking..."))]))}},ne=A(te,[["__scopeId","data-v-f906eadb"]]);export{ne as default};
